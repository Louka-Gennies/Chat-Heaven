<!DOCTYPE html>
<html lang="">
<head>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <title>Post Submission</title>
    <link rel="stylesheet" href="../static/css/header.css">
    <link rel="stylesheet" href="../static/css/footer.css">
    <link rel="stylesheet" href="../static/css/breadcrumb.css">
    <link rel="stylesheet" href="../static/css/posts.css">
</head>
<header>
    <div class="logo">
        <a href="/">
        </a>
    </div>
    <div class="search">
        <input type="text" id="search-input" placeholder="Search...">
        <svg width="30" height="30" viewBox="0 0 50 50" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M21.6787 0.0619393C9.72446 0.0619393 0 9.7864 0 21.7407C0 33.695 9.72446 43.4194 21.6787 43.4194C25.3332 43.4194 28.9256 42.5523 31.9607 40.8799C32.2038 41.1725 32.4733 41.442 32.7659 41.6851L38.9598 47.879C39.5317 48.5226 40.2291 49.0425 41.0093 49.4067C41.7894 49.771 42.6357 49.9719 43.4963 49.9973C44.3569 50.0226 45.2136 49.8718 46.0138 49.554C46.814 49.2363 47.5408 48.7584 48.1496 48.1496C48.7584 47.5408 49.2363 46.814 49.554 46.0138C49.8718 45.2136 50.0226 44.3569 49.9973 43.4963C49.9719 42.6357 49.771 41.7894 49.4067 41.0093C49.0425 40.2292 48.5226 39.5317 47.879 38.9598L41.6851 32.7659C41.3834 32.464 41.0513 32.1942 40.6941 31.9607C42.3664 28.9256 43.4194 25.3951 43.4194 21.6787C43.4194 9.72446 33.695 0 21.7407 0L21.6787 0.0619393ZM21.6787 6.25586C30.2883 6.25586 37.1636 13.1311 37.1636 21.7407C37.1636 25.8287 35.677 29.607 33.0756 32.3942C33.0136 32.4562 32.9517 32.5181 32.8897 32.58C32.5972 32.8232 32.3276 33.0927 32.0845 33.3853C29.3592 35.8628 25.6428 37.2874 21.6168 37.2874C13.0072 37.2874 6.13199 30.4122 6.13199 21.8026C6.13199 13.1931 13.0072 6.3178 21.6168 6.3178L21.6787 6.25586Z" fill="#515151"/>
        </svg>
    </div>
    {{if .}}
    <div class="pfp">
        <a href="/user?username={{.Username}}" class="username">{{.Username}}</a>
        <a href="/user?username={{.Username}}" class="profile"><img src="{{.ProfilePicture}}" alt="Photo de profil" href="/user?username={{.Username}}" ></a>
    </div>
    {{else}}
    <div class="login"><a href="/login">Login</a></div>
    {{end}}
</header>
<body>
<main>
    <div class="breadcrumb">
        <a href="/">Main page</a> > <a href="/topics">Topics</a> > <span>Posts</span>
    </div>

    <h2>{{.Topic}}</h2>
    <h4>{{.TopicDescription}}</h4>

    <div class="button-container">
        <div class ="sort-buttons">
            <button class="sort-button" id="sort-likes" onclick="window.location.href='/posts?topic={{.Topic}}&sort=likes'">Sort by likes</button>
            <button class="sort-button" id="sort-comments" onclick="window.location.href='/posts?topic={{.Topic}}&sort=comments'">Sort by comments</button>
            <button class="sort-button" id="sort-date" onclick="window.location.href='/posts?topic={{.Topic}}&sort=date'">Sort by date</button>
            <button class="sort-button" id="sort-author" onclick="window.location.href='/posts?topic={{.Topic}}&sort=author'">Sort by author</button>
            <button class="sort-button" id="sort-title" onclick="window.location.href='/posts?topic={{.Topic}}'">Reset</button>
        </div>
        <a href="/create-post?topic={{.Topic}}" class="create-post"> + New Post</a>
    </div>
    <div class="forum">
        <table>
            <tr>
                <th class="tab-post">Post</th>
                <th class="author">Author</th>
                <th class="post-likes">Votes</th>
                <th class="post-comments">Comments</th>
            </tr>
            {{range .Post}}
            <tr>
                <td>
                    <div class="post-container">
                        <svg version="1.0" xmlns="http://www.w3.org/2000/svg"
                            width="47.000000pt" height="42.000000pt" viewBox="0 0 47.000000 42.000000"
                            preserveAspectRatio="xMidYMid meet">

                            <g transform="translate(0.000000,42.000000) scale(0.100000,-0.100000)"
                            fill="#000000" stroke="none">
                            <path d="M154 287 c-2 -7 -4 -52 -2 -98 l3 -84 85 0 85 0 0 95 0 95 -83 3
                            c-63 2 -84 0 -88 -11z m156 -87 l0 -80 -70 0 -70 0 0 80 0 80 70 0 70 0 0 -80z"/>
                            <path d="M190 240 c0 -5 11 -10 25 -10 14 0 25 5 25 10 0 6 -11 10 -25 10 -14
                            0 -25 -4 -25 -10z"/>
                            <path d="M190 200 c0 -5 23 -10 50 -10 28 0 50 5 50 10 0 6 -22 10 -50 10 -27
                            0 -50 -4 -50 -10z"/>
                            <path d="M190 160 c0 -5 23 -10 50 -10 28 0 50 5 50 10 0 6 -22 10 -50 10 -27
                            0 -50 -4 -50 -10z"/>
                            </g>
                        </svg>
                        <a href="/post-content?postID={{.ID}}" class="post-title"><h3>{{.Title}}</h3></a>
                    </div>
                </td>
                <td class = "table-author">
                    <p> By
                        <a href="/user?username={{.User}}">{{.User}} </a>
                    </p>
                    <span class ="post-date"> {{.Date}}</span>
                </td>
                <td class = "likes">{{.LikeDislikeDifference}}</td>
                <td class = "comments">{{.NbComments}}</td>
            </tr>
            {{end}}
        </table>
    </div>
</main>
<div class="footer">
    <p>Chat HeavenÂ©</p>
</div>
</body>
<script src="../static/js/search-autocomplete.js"></script>
<script>
    const urlParams = new URLSearchParams(window.location.search);
    const sortParam = urlParams.get('sort');

    if (sortParam) {
        const activeButton = document.getElementById(`sort-${sortParam}`);
        if (activeButton) {
            activeButton.classList.add('active');
        }
    }
</script>
</html>